<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Traffic Knowledge Quiz</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link rel="stylesheet" href="style.css">

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

  <!-- Firebase Config -->
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAJT61cprsH6Zxsv4xvubfMnKlk3XSq3gE",
      authDomain: "traffic-quiz-6eaa3.firebaseapp.com",
      projectId: "traffic-quiz-6eaa3",
      storageBucket: "traffic-quiz-6eaa3.firebasestorage.app",
      messagingSenderId: "1011063341314",
      appId: "1:1011063341314:web:2f4602a1dd1887d3b0821b"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore(); // üëâ used by JS to save to admin
  </script>

  <!-- üåê GOOGLE TRANSLATOR -->
  <script>
    function googleTranslateElementInit() {
      new google.translate.TranslateElement(
        {
          pageLanguage: 'en',
          includedLanguages: 'en,te',
          layout: google.translate.TranslateElement.InlineLayout.SIMPLE
        },
        'google_translate_element'
      );
    }
  </script>
</head>

<body>

<!-- ================= SPLASH ================= -->
<div id="introScreen" class="intro-screen">
  <img src="logo.jpeg" class="intro-logo" alt="TGTD Logo">
  <p class="intro-text">Powered by Telangana Transport Department</p>
</div>

<!-- ================= START SCREEN ================= -->
<div id="startScreen" class="screen hidden">
  <img src="logo.jpeg" class="corner-logo">

  <div class="quiz-card">

    <!-- TRANSLATOR -->
    <div style="text-align:right;margin-bottom:10px;">
      <div id="google_translate_element"></div>
    </div>

    <h1>Traffic Knowledge for Students</h1>
    <p>Test your traffic education knowledge</p>
    <p>Start a small quiz of 5 questions</p>

    <input
      type="text"
      id="usernameInput"
      placeholder="Enter your name"
      style="
        width:100%;
        padding:12px;
        margin:15px 0;
        font-size:1rem;
        border-radius:8px;
        border:1px solid #ccc;
      "
    />

    <button class="primary-btn" onclick="startQuiz()">Start Quiz</button>
  </div>
</div>

<!-- ================= QUIZ ================= -->
<div id="quizScreen" class="screen hidden">
  <img src="logo.jpeg" class="corner-logo">

  <!-- QUESTION NAV -->
  <div class="question-nav" id="questionNav" translate="no"></div>

  <!-- NAV LEGEND -->
  <div class="nav-legend" translate="no">
    <span style="color:#1e3a8a;">‚óè</span> Current &nbsp;
    <span style="color:#16a34a;">‚óè</span> Answered &nbsp;
    <span style="color:#facc15;">‚óè</span> Visited
  </div>

  <div class="quiz-card">

    <div class="progress-container">
      <div class="progress-bar" id="progressBar"></div>
    </div>

    <!-- QUESTION COUNTER (TRANSLATE SAFE) -->
    <div class="top-bar" translate="no">
      <span id="questionLabel">Question</span>
      <span id="attempted">1</span> /
      <span id="totalQ">5</span>
    </div>

    <h2 id="question"></h2>
    <img id="qImage" class="q-image hidden">

    <div id="options">
      <button class="option-btn" data-option="1" onclick="selectOption(1,this)">
        A. <span id="o1"></span>
      </button>
      <button class="option-btn" data-option="2" onclick="selectOption(2,this)">
        B. <span id="o2"></span>
      </button>
      <button class="option-btn" data-option="3" onclick="selectOption(3,this)">
        C. <span id="o3"></span>
      </button>
      <button class="option-btn" data-option="0" onclick="selectOption(0,this)">
        D. <span>None of the above</span>
      </button>
    </div>

    <div style="display:flex;justify-content:space-between;margin-top:20px">
      <button class="secondary-btn" onclick="goBack()">Back</button>
      <button class="primary-btn" onclick="nextQuestion()">Next</button>
    </div>
  </div>
</div>

<!-- ================= RESULT ================= -->
<div id="resultScreen" class="screen hidden">
  <div class="quiz-card" style="max-height:90vh;display:flex;flex-direction:column;">

    <!-- SCORE RING -->
    <div class="score-ring-wrapper">
      <svg class="score-ring" width="180" height="180">
        <circle class="ring-bg" cx="90" cy="90" r="80"></circle>
        <circle class="ring-progress" cx="90" cy="90" r="80"></circle>
      </svg>
      <div class="score-ring-text">
        <span id="ringScore">0</span>
        <small>%</small>
      </div>
    </div>

    <h3 id="finalScore"></h3>

    <!-- üîΩ SHOW / HIDE REVIEW TOGGLE -->
    <button
      class="secondary-btn"
      id="toggleReviewBtn"
      style="margin-top:10px"
      onclick="toggleReview()">
      Show Answer Review
    </button>

    <!-- REVIEW SECTION -->
    <div
      id="reviewWrapper"
      style="
        display:none;
        flex:1;
        overflow-y:auto;
        margin-top:15px;
        border-top:1px solid #ddd;
        padding-top:10px;
      ">

      <h4 style="text-align:left;">Answer Review</h4>

      <div id="reviewSection"></div>
    </div>

    <!-- RESTART -->
    <button
      class="primary-btn"
      style="margin-top:15px"
      onclick="location.reload()">
      Restart Quiz
    </button>

  </div>
</div>

<!-- MAIN SCRIPT -->
<script src="script.js" defer></script>

<!-- GOOGLE TRANSLATE -->
<script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<!-- SPLASH AUTO HIDE -->
<script>
  setTimeout(() => {
    document.getElementById("introScreen").style.display = "none";
    document.getElementById("startScreen").classList.remove("hidden");
  }, 2000);
</script>

</body>
</html>
